[TOC]

## 登录窗口

### 检查微信版本是否匹配

```c++
//************************************************************
// 函数名称: IsWxVersionValid
// 函数说明: 检查微信版本是否匹配
// 作    者: GuiShou
// 时    间: 2019/6/30
// 参    数: void
// 返 回 值: BOOL
//************************************************************
BOOL IsWxVersionValid()
```

### 检查微信是否登陆

```c++
//************************************************************
// 函数名称: CheckIsLogin
// 函数说明: 检查微信是否登陆
// 作    者: GuiShou
// 时    间: 2019/6/30
// 参    数: void
// 返 回 值: BOOL 是否登录
//************************************************************
BOOL CheckIsLogin()
```

### 跳转到二维码页面

```c++
//************************************************************
// 函数名称: GotoQrCode
// 函数说明: 跳转到二维码窗口
// 作    者: GuiShou
// 时    间: 2019/6/16
// 参    数: void
// 返 回 值: void
//************************************************************
void GotoQrCode()
```

### HOOK拦截二维码

```c++
//************************************************************
// 函数名称: HookQrCode
// 函数说明: HOOK微信二维码
// 作    者: GuiShou
// 时    间: 2019/6/30
// 参    数: DWORD dwHookOffset 要hook的偏移 
// 返 回 值: void  (函数执行之后会将二维码保存到temp目录下的qrcode.png)
//************************************************************
void HookQrCode()
```

## 功能窗口

### 获取个人信息

```c++
//************************************************************
// 函数名称: GetInformation
// 函数说明: 获取个人信息
// 作    者: GuiShou
// 时    间: 2019/7/7
// 参    数: info 个人信息结构体
// 返 回 值: void 
//************************************************************
void GetInformation(Information *info)
//个人信息的结构体
struct Information
{
	wchar_t wxid[40];		//微信ID
	wchar_t wxcount[40];	//微信账号
	wchar_t nickname[40];	//微信昵称
	wchar_t wxsex[4];		//性别
	wchar_t phone[30];		//手机号
	wchar_t device[15];		//登陆设备
	wchar_t nation[10];		//国籍
	wchar_t province[20];	//省份
	wchar_t city[20];		//城市
	wchar_t header[0x100];	//头像
};
```

### 添加好友

```c++
//************************************************************
// 函数名称: AddWxUser
// 函数说明: 添加好友
// 作    者: GuiShou
// 时    间: 2019/7/13
// 参    数: wxid 微信ID msg添加好友时要发送的消息
// 返 回 值: void 
//************************************************************
void AddWxUser(wchar_t* wxid, wchar_t* msg)
```

### 防撤回

```c++
//************************************************************
// 函数名称: AntiRevoke
// 函数说明: 防撤回
// 作    者: GuiShou
// 时    间: 2019/7/15
// 参    数: void
// 返 回 值: void 
//************************************************************
void AntiRevoke()
```

